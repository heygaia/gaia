---
title: "Add a new environment variable"
description: "Backend settings, validation, and frontend env usage"
icon: "key"
---

### TL;DR
- Backend single source: `backend/app/config/settings.py`.
- Dev: make new fields Optional; Prod: make required if mandatory.
- Use `settings` in code; for external clients, add a lazy provider.
- Frontend: only add `NEXT_PUBLIC_*` when strictly needed; validated via `frontend/src/lib/api/client.ts`.

### Backend: add the field
```python
# backend/app/config/settings.py
class DevelopmentSettings(CommonSettings):
  MY_API_KEY: Optional[str] = None

class ProductionSettings(CommonSettings):
  MY_API_KEY: str  # required in prod
```

(Optional) group in validator for warnings:
```python
# backend/app/config/settings_validator.py
# register group and log warnings if missing (implementation already present)
```

Use in code:
```python
from app.config.settings import settings
print(settings.MY_API_KEY)
```

Back it with a lazy provider (recommended for clients):
```python
from app.core.lazy_loader import lazy_provider, MissingKeyStrategy
from app.config.settings import settings

@lazy_provider(
  name="my_api_client",
  required_keys=[settings.MY_API_KEY],
  strategy=MissingKeyStrategy.WARN,
)
def create_my_api_client():
  ...
```

### Frontend: add only if necessary
- Prefer using existing `NEXT_PUBLIC_API_BASE_URL`.
- If you must add one: define `NEXT_PUBLIC_MY_SETTING` and read via `process.env.NEXT_PUBLIC_MY_SETTING`.
- Keep validation centralized in modules that use it; avoid scattering checks.

Validated base URL example:
```ts
// frontend/src/lib/api/client.ts
if (!process.env.NEXT_PUBLIC_API_BASE_URL) {
  throw new Error("Missing required environment variable: NEXT_PUBLIC_API_BASE_URL");
}
```

Keep it minimal for local devâ€”add keys as you enable features.

See also: [Lazy loading env & providers](/developers/extra/lazy-loading) 